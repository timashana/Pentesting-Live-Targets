# Project 8 - Pentesting Live Targets
Penetration testing 3 different websites for the Codepath cybersecurity class
 
Time spent: **6** hours spent in total

> Objective: Identify vulnerabilities in three different versions of the Globitek website: blue, green, and red.

The six possible exploits are:
* Username Enumeration
* Insecure Direct Object Reference (IDOR)
* SQL Injection (SQLi)
* Cross-Site Scripting (XSS)
* Cross-Site Request Forgery (CSRF)
* Session Hijacking/Fixation

Each version of the site has been given two of the six vulnerabilities. (In other words, all six of the exploits should be assignable to one of the sites.)

## Blue

Vulnerability #1: SQLi - "Find a Salesperson" page is vulnerable to SQL Injection
- If 'OR SLEEP(5)=0--' is URL-encoded and inserted as the value for id at the end of the page address, there is a noticeable delay and the first salesman's (id=1) page is returned:

![sqli](https://user-images.githubusercontent.com/31852525/39104967-e842e2a0-4680-11e8-9b3f-855f9879aec9.gif)

Vulnerability #2: Session Hijacking/Fixation - the session ID is persistent and can be transferred to an unauthenticated browser
- Copy the session id from a logged-in browser into a different one. The new browser will be authenticated:

![session](https://user-images.githubusercontent.com/31852525/39105042-561b875a-4681-11e8-8610-63281c20c997.gif)

## Green

Vulnerability #1: User Enumeration:
- Given a wrong password at the login page, the error message text's style is different for existing users and non-existent users:

![enumeration](https://user-images.githubusercontent.com/31852525/39105091-c9a39c1c-4681-11e8-9d55-76788e190cea.gif)

Vulnerability #2: XSS - "Contact" page is vulnerable to Cross-Site Scripting:
- Put an XSS script in "Contact" form and it will be executed when a user opens the "Feedback" section:

![xss](https://user-images.githubusercontent.com/31852525/39105143-30177018-4682-11e8-9570-24f9b16eb92e.gif)

## Red

Vulnerability #1: IDOR - "Find a Salesperson"'s URL can be manipulated to reveal hidden salesmen:
- On the "Find a Salesperson" page, edit the "id" part of the URL to have value 10 or 11 (both salesmen should not be visible):

![idor](https://user-images.githubusercontent.com/31852525/39105209-a2e3b3e0-4682-11e8-80d4-5fb2bc6a9f64.gif)

Vulnerability #2: CSRF - unvalidated CSRF token allows users to update information in the database freely:
- Create an html form to trick a logged-in user to submit changes into the database:

![csrf](https://user-images.githubusercontent.com/31852525/39105399-9932c07e-4683-11e8-86bd-5ddadcf31467.gif)

## Bonus Objective:

Build on Objective #3 (SQL Injection): Knowing that Blue website is vulnerable to SQL Injection, we can use SQLMap to get all the available information:
- Run SQLMap and point it to the vulnerable website's URL with options --all (to see all info) and --threads 10 (to speed up process): 




## Notes

Following the html form that updates user #1 to be Joe Black that loves peanut butter:
<html>
  <head>
    <title>Le Form</title>
  </head>
  <body onload="document.edit_salesperson.submit()">
    <form action="https://146.148.50.237/red/public/staff/salespeople/edit.php?id=1" method="POST" name="edit_salesperson" style="display: none;" target="hidden_results" >
      <input type="text" name="first_name" value="Joe"><br>
      <input type="text" name="last_name" value="Black"><br>
      <input type="text" name="phone" value="666-666-6666"><br>
      <input type="text" name="email" value="iluv@peanut.butter"><br>
    </form>
    <iframe name="hidden_results" style="display: none;"></iframe>
  </body>
</html>

